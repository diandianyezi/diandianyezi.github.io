import{_ as n,W as a,X as s,a2 as t}from"./framework-609d4fec.js";const p={},o=t(`<h1 id="点击劫持-click-jacking" tabindex="-1"><a class="header-anchor" href="#点击劫持-click-jacking" aria-hidden="true">#</a> 点击劫持 Click-jacking</h1><p>点击劫持是一种在视觉上的欺骗手段，攻击者使用一个透明的、不可见的iframe，覆盖在一个网页上，然后诱使用户在该网页上进行操作，此时用户在不知情的情况下点击透明的iframe页面，通过调整iframe页面位置，可以诱使用户恰好点击在iframe页面的功能性按钮上。</p><p>点击劫持攻击与 CSRF 攻击(详见“跨站点请求伪造”一章)有异曲同工之妙，都是在用 户不知情的情况下诱使用户完成一些动作。但是在 CSRF 攻击的过程中，如果出现用户交互的 页面，则攻击可能会无法顺利完成。与之相反的是，点击劫持没有这个顾虑，它利用的就是与 用户产生交互的页面。</p><h3 id="flash点击劫持" tabindex="-1"><a class="header-anchor" href="#flash点击劫持" aria-hidden="true">#</a> Flash点击劫持</h3><h3 id="图片覆盖攻击" tabindex="-1"><a class="header-anchor" href="#图片覆盖攻击" aria-hidden="true">#</a> 图片覆盖攻击</h3><p>Cross Site Image Overlaying 攻击 简称XSIO</p><p>在防御 XSIO 时，需要检查用户提交的 HTML 代码中，<img>标签的 style 属性是 否可能导致浮出。</p><h3 id="拖拽劫持与数据窃取" tabindex="-1"><a class="header-anchor" href="#拖拽劫持与数据窃取" aria-hidden="true">#</a> 拖拽劫持与数据窃取</h3><p>诱使用户从隐藏的不可见iframe中拖拽出攻击者希望得到的数据，然后放到攻击者能控制的另外一个页面中，从而窃取数据。</p><h3 id="触屏劫持" tabindex="-1"><a class="header-anchor" href="#触屏劫持" aria-hidden="true">#</a> 触屏劫持</h3><h3 id="防御措施" tabindex="-1"><a class="header-anchor" href="#防御措施" aria-hidden="true">#</a> 防御措施</h3><ol><li>一般是 通过禁止跨域的 iframe 来防范。</li></ol><p>通常可以写一段JavaScript代码，以禁止iframe的嵌套。这种方法叫frame busting。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 常见frame busting</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>top <span class="token operator">!=</span> self<span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>top<span class="token punctuation">.</span>location <span class="token operator">!=</span> self<span class="token punctuation">.</span>location<span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>top<span class="token punctuation">.</span>location <span class="token operator">!=</span> location<span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">.</span>frames<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>window <span class="token operator">!=</span> top<span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>top <span class="token operator">!==</span> window<span class="token punctuation">.</span>self<span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>self <span class="token operator">!=</span> window<span class="token punctuation">.</span>top<span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">&amp;&amp;</span> parent <span class="token operator">!=</span> window<span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">&amp;&amp;</span> parent<span class="token punctuation">.</span>frames <span class="token operator">&amp;&amp;</span> parent<span class="token punctuation">.</span>frames<span class="token punctuation">.</span>length<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>parent<span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>parent<span class="token operator">===</span>self<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>frames<span class="token punctuation">.</span>length<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> top<span class="token punctuation">.</span>location <span class="token operator">=</span> self<span class="token punctuation">.</span>location
top<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> document<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href
top<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> self<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href top<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>location<span class="token punctuation">)</span>
top<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href top<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>location<span class="token punctuation">)</span>
top<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href
top<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">&quot;URL&quot;</span>
document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span>
top<span class="token punctuation">.</span>location <span class="token operator">=</span> location
top<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>location<span class="token punctuation">)</span> top<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&#39;URL&#39;</span><span class="token punctuation">)</span>
top<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> document<span class="token punctuation">.</span>location top<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">)</span>
top<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> location<span class="token punctuation">.</span>href
self<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>location <span class="token operator">=</span> document<span class="token punctuation">.</span>location
parent<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> self<span class="token punctuation">.</span>document<span class="token punctuation">.</span>location
top<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> self<span class="token punctuation">.</span>location
top<span class="token punctuation">.</span>location <span class="token operator">=</span> window<span class="token punctuation">.</span>location top<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>pathname<span class="token punctuation">)</span> window<span class="token punctuation">.</span>top<span class="token punctuation">.</span>location <span class="token operator">=</span> window<span class="token punctuation">.</span>self<span class="token punctuation">.</span>location <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>innerHTML<span class="token operator">=</span><span class="token string">&#39;&#39;</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> window<span class="token punctuation">.</span>self<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span><span class="token punctuation">{</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>innerHTML<span class="token operator">=</span><span class="token string">&#39;&#39;</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">var</span> url <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">;</span> top<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>此外，像 HTML 5 中 iframe 的 sandbox 属性、IE 中 iframe 的 security 属性等，都可以限制 iframe 页面中的 JavaScript 脚本执行，从而可以使得 frame busting 失效。</p><ol start="2"><li>X-Frame-Options</li></ol><p>使用HTTP头-X-Frame-Options</p><p>可选值：</p><ul><li>DENY</li><li>SAMEORIGIN</li><li>ALLOW-FROM origin</li></ul><p>当值为 DENY 时，浏览器会拒绝当前页面加载任何 frame 页面;若值为 SAMEORIGIN， 则 frame 页面的地址只能为同源域名下的页面;若值为 ALLOW-FROM，则可以定义允许 frame 加载的页面地址。</p><p>除了 X-Frame-Options 之外，Firefox 的“Content Security Policy”以及 Firefox 的 NoScript 扩展也能够有效防御 ClickJacking，这些方案为我们提供了更多的选择。</p>`,21),c=[o];function e(i,l){return a(),s("div",null,c)}const r=n(p,[["render",e],["__file","点击劫持.html.vue"]]);export{r as default};
